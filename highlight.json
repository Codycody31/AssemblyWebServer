[
  [
    {
      "text": "SYS_WRITE",
      "highlight": "keyword"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; write text to stdout",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_READ",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; read text from stdin",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_EXIT",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "60",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; terminate the program",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_SOCKET",
      "highlight": "keyword"
    },
    {
      "text": "  ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "41",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; create a socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "STDOUT",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; stdout",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SOCK_STREAM",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; stream socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "AF_INET",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "2",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; IPv4",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_BIND",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "49",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; bind a socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_LISTEN",
      "highlight": "keyword"
    },
    {
      "text": "  ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "50",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; listen for connections",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_ACCEPT",
      "highlight": "keyword"
    },
    {
      "text": "  ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "43",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; accept a connection",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "SYS_CLOSE",
      "highlight": "keyword"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "equ",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "3",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; close a file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Data definitions",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "struc",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ".sin_family",
      "highlight": "property"
    },
    {
      "text": " resw 1",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ".sin_port",
      "highlight": "property"
    },
    {
      "text": " resw 1",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ".sin_addr",
      "highlight": "property"
    },
    {
      "text": " resd 1",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ".sin_zero",
      "highlight": "property"
    },
    {
      "text": " resb 8",
      "highlight": null
    }
  ],
  [
    {
      "text": "endstruc",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "section",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": ".bss",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; BSS section for uninitialized data",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "sock",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "resw",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "4",
      "highlight": "number"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "; Socket file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "client",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "resw",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "4",
      "highlight": "number"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; Client file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "port_str",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "resb",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "6",
      "highlight": "number"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; Buffer to store port string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "echobuf",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "resb",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "256",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "read_count",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "resw",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "2",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "section",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": ".data",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "welcome_msg",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Welcome to the Web Server in Assembly!\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0xA",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "welcome_msg_len",
      "highlight": "keyword"
    },
    {
      "text": " equ $ - welcome_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "port_attempt_msg",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Attempting to bind to port: \"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "port_attempt_msg_len",
      "highlight": "keyword"
    },
    {
      "text": " equ $ - port_attempt_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "port_msg",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Server is listening on port: \"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "port_msg_len",
      "highlight": "keyword"
    },
    {
      "text": " equ $ - port_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "connection_msg",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Accepted connection!\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0xA",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "connection_msg_len",
      "highlight": "keyword"
    },
    {
      "text": " equ $ - connection_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "sock_err_msg",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Failed to initialise socket\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "sock_err_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "    equ $ - sock_err_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "bind_err_msg",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Failed to bind socket to listening address\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "bind_err_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "    equ $ - bind_err_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "lstn_err_msg",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Failed to listen on socket\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "lstn_err_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "    equ $ - lstn_err_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "accept_err_msg",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Could not accept connection attempt\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "accept_err_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "  equ $ - accept_err_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "accept_msg",
      "highlight": "keyword"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Client connected!\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "accept_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "      equ $ - accept_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "response_msg",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " `HTTP/1.1 ",
      "highlight": null
    },
    {
      "text": "200",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "OK",
      "highlight": "property"
    },
    {
      "text": "\\",
      "highlight": null
    },
    {
      "text": "nConnection",
      "highlight": "property"
    },
    {
      "text": ": ",
      "highlight": null
    },
    {
      "text": "close",
      "highlight": "property"
    },
    {
      "text": "\\nContent-length: ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "\\",
      "highlight": null
    },
    {
      "text": "n",
      "highlight": "property"
    },
    {
      "text": "\\",
      "highlight": null
    },
    {
      "text": "n",
      "highlight": "property"
    },
    {
      "text": "`",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "response_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "    equ $ - response_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "close_msg",
      "highlight": "keyword"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"Closing connection\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0x0a",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "close_msg_len",
      "highlight": "keyword"
    },
    {
      "text": "       equ $ - close_msg",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "default_port_str",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "\"8000\"",
      "highlight": "string"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "default_port_str_len",
      "highlight": "keyword"
    },
    {
      "text": " equ $ - default_port_str",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "newline",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "db",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "0xA",
      "highlight": "number"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; Newline",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; sockaddr_in structure for the address the listening socket binds to",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop_sa",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "istruc",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "at",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in.sin_family",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "dw",
      "highlight": "property"
    },
    {
      "text": " 2            ",
      "highlight": null
    },
    {
      "text": "; AF_INET",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "at",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in.sin_port",
      "highlight": "property"
    },
    {
      "text": ", dw ",
      "highlight": null
    },
    {
      "text": "0xa1ed",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; port 60833",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "at",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in.sin_addr",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "dd",
      "highlight": "property"
    },
    {
      "text": " 0             ",
      "highlight": null
    },
    {
      "text": "; localhost",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "at",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "sockaddr_in.sin_zero",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "dd",
      "highlight": "property"
    },
    {
      "text": " 0, ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "iend",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "sockaddr_in_len",
      "highlight": "keyword"
    },
    {
      "text": "     equ $ - pop_sa",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "section",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": ".text",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "global",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "_start",
      "highlight": "function"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "_start",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Initialise listening and client socket values to 0, used for cleanup handling",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "      word [sock], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "      word [client], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write welcome msg to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "welcome_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "welcome_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "write_string",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; write first part of port attmpt msg, must do before due to popping ltr to rsi",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "port_attempt_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "port_attempt_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "write_string",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; pop the arg count",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; pop the program name",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; pop the only argument",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Check if a port number was provided",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "test",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "; Test if RSI is zero (no argument provided)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jz",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "use_default_port",
      "highlight": "property"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "; If zero, use the default port",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "     byte [rsi], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "; Check if the first byte is null (empty string)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jne",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "port_provided",
      "highlight": "property"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "; If not null, port number is provided",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "use_default_port",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Use default port if none provided",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "default_port_str",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "port_provided",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Calculate the length of the port number string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; Clear rcx to use as a counter",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; Copy rsi to rdi to use it in the loop",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "calc_length",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Calculate the length of the port number string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Done to prevent the fetching of more memory then we are suppose to, given that if we did mov rdx, [rsi] it would result in dumping the shell stuff also",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; For example env vars and other things and not just the port number as expected",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "     byte [rdi], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "; Check if the current byte is 0 (end of string)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "je",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "length_done",
      "highlight": "property"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "; If it is, we're done",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "inc",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; Move to the next byte",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "inc",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; Increment the counter (size of port number stored at rsi)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jmp",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "calc_length",
      "highlight": "property"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "; Repeat the loop",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "length_done",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write the port number string to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_WRITE",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "STDOUT",
      "highlight": "property"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; file descriptor for STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; rsi already holds the port number string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": "                ",
      "highlight": null
    },
    {
      "text": "; rdx holds the length of the string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Mov the string length to r13, and the string to r14",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "r13",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "r14",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write newline to STDOUT but preserve rsi",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "r15",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "write_newline",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "r15",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "string_to_int",
      "highlight": "property"
    },
    {
      "text": "  ",
      "highlight": null
    },
    {
      "text": "; convert the argument string to int",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; we need to make the int to reverse byte order",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "bl",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "ah",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "bh",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "al",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": " [pop_sa + sockaddr_in.sin_port], ",
      "highlight": null
    },
    {
      "text": "bx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Initialize socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "_socket",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Bind and Listen",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "_listen",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write port msg to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_WRITE",
      "highlight": "property"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "STDOUT",
      "highlight": "property"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "; file descriptor for STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "port_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "port_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Mov the string length to r13, and the string to r14",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "r13",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "r14",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write the port number string to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_WRITE",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "STDOUT",
      "highlight": "property"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; file descriptor for STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; rsi already holds the port number string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    },
    {
      "text": "                ",
      "highlight": null
    },
    {
      "text": "; rdx holds the length of the string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "r13",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "r13",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "r14",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "r14",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Write newline to STDOUT but preserve rsi",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "write_newline",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Main loop handles clients connecting (accept()) then echoes any input",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": ";; back to the client",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "     .mainloop:",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "_accept",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ";; Read and re-send all bytes sent by the client until the client hangs",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ";; up the connection on their end.",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; .readloop:",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ";     call     _read",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "_echo",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": ";; read_count is set to zero when client hangs up",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; mov     rax, [read_count]",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; cmp     rax, 0",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ";     jmp      .read_complete",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; jmp .readloop",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; .read_complete:",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ";; Close client socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; mov rax, 35",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; mov rdi, timespec",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; xor rsi, rsi",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; syscall",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [client]",
      "highlight": null
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "_close_sock",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "    word [client], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "jmp",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ".mainloop",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": ";; Exit with success (return 0)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "_exit",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Performs a sys_socket call to initialise a TCP/IP listening socket, storing",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; socket file descriptor in the sock variable",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_socket",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Create a socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_SOCKET",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_SOCKET",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "AF_INET",
      "highlight": "property"
    },
    {
      "text": "           ",
      "highlight": null
    },
    {
      "text": "; AF_INET",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SOCK_STREAM",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; SOCK_STREAM",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; Protocol (0 -> IP)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Check socket was created correctly",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jle",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "_socket_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Store socket descriptor in variable",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     [sock], ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "; Save socket file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Calls sys_bind and sys_listen to start listening for connections",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_listen",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Bind the socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_BIND",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_BIND",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [sock]   ",
      "highlight": null
    },
    {
      "text": "; Socket file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "lea",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "pop_sa",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; Pointer to sockaddr_in",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "sockaddr_in_len",
      "highlight": "property"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; Size of sockaddr_in",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Check socket was bound correctly",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; TODO: Bind logic seems to be failing",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jl",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "_bind_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Listen on the socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_LISTEN",
      "highlight": "property"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_LISTEN",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; Backlog",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Check socket was bound correctly",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jl",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "_listen_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "string_to_int",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "ebx",
      "highlight": "property"
    },
    {
      "text": ",",
      "highlight": null
    },
    {
      "text": "ebx",
      "highlight": "property"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; clear ebx",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    },
    {
      "text": ",",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    }
  ],
  [
    {
      "text": ".next_digit:",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "movzx",
      "highlight": "keyword"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    },
    {
      "text": ",byte[rsi]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jz",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": ".finished",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "inc",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "sub",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "al",
      "highlight": "property"
    },
    {
      "text": ",'",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "'    ",
      "highlight": null
    },
    {
      "text": "; convert from ASCII to number",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "imul",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ebx",
      "highlight": "property"
    },
    {
      "text": ",",
      "highlight": null
    },
    {
      "text": "10",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "add",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "ebx",
      "highlight": "property"
    },
    {
      "text": ",",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    },
    {
      "text": "   ",
      "highlight": null
    },
    {
      "text": "; ebx = ebx*10 + eax",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jmp",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": ".next_digit",
      "highlight": "property"
    },
    {
      "text": "  ",
      "highlight": null
    },
    {
      "text": "; while (--ecx)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    .finished:",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "eax",
      "highlight": "property"
    },
    {
      "text": ",",
      "highlight": null
    },
    {
      "text": "ebx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; return with the result in eax",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "; --------------------------------",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "; Helper function to convert integer to string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "; Input: AX (16-bit integer)",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "; Output: port_str",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "; --------------------------------",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "int_to_str",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "push",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rbx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "push",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "push",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rbx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "10",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "lea",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [port_str + ",
      "highlight": null
    },
    {
      "text": "5",
      "highlight": "number"
    },
    {
      "text": "]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     byte [rdi], ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; Null-terminate the string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ".convert_loop:",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "xor",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "div",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rbx",
      "highlight": "property"
    },
    {
      "text": "              ",
      "highlight": null
    },
    {
      "text": "; Divide AX by 10",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "add",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "dl",
      "highlight": "property"
    },
    {
      "text": ", '",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "'",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "dec",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     [rdi], ",
      "highlight": null
    },
    {
      "text": "dl",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "or",
      "highlight": "keyword"
    },
    {
      "text": "      ",
      "highlight": null
    },
    {
      "text": "ax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "ax",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "jnz",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": ".convert_loop",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rcx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "pop",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rbx",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Accepts a connection from a client, storing the client socket file descriptor",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; in the client variable and logging the connection to stdout",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_accept",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Call sys_accept",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "43",
      "highlight": "number"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; SYS_ACCEPT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [sock]     ",
      "highlight": null
    },
    {
      "text": "; listening socket fd",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; NULL sockaddr_in value as we don't need that data",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; NULLs have length 0",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Check call succeeded",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "jl",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "_accept_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Store returned fd in variable",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     [client], ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Log connection to stdout",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "             ",
      "highlight": null
    },
    {
      "text": "; STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "accept_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "accept_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Reads up to 256 bytes from the client into echobuf and sets the read_count variable",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; to be the number of bytes read by sys_read",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_read",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Call sys_read",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    },
    {
      "text": "          ",
      "highlight": null
    },
    {
      "text": "; SYS_READ",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [client]   ",
      "highlight": null
    },
    {
      "text": "; client socket fd",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "echobuf",
      "highlight": "property"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; buffer",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "256",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; read 256 bytes",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": ";; Copy number of bytes read to variable",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     [read_count], ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; Sends up to the value of read_count bytes from echobuf to the client socket",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": ";; using sys_write",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_echo",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "               ",
      "highlight": null
    },
    {
      "text": "; SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [client]        ",
      "highlight": null
    },
    {
      "text": "; client socket fd",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "response_msg",
      "highlight": "property"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": "; buffer",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "response_msg_len",
      "highlight": "property"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "; number of bytes received in _read",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Performs sys_close on the socket in rdi",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_close_sock",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "SYS_CLOSE",
      "highlight": "property"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; SYS_CLOSE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Error Handling code",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; _*_fail handle the population of the rsi and rdx registers with the correct",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; error msgs for the labelled situation. They then call _fail to show the",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; error msg and exit the application.",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_socket_fail",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "sock_err_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "sock_err_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "_bind_fail",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "bind_err_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "bind_err_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "_listen_fail",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "lstn_err_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "lstn_err_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "_accept_fail",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "accept_err_msg",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "accept_err_msg_len",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "_fail",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Calls the sys_write syscall, writing an error msg to stderr, then exits",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; the application. rsi and rdx must be populated with the error msg and",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; length of the error msg before calling _fail",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_fail",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "2",
      "highlight": "number"
    },
    {
      "text": " ",
      "highlight": null
    },
    {
      "text": "; STDERR",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "_exit",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Exits cleanly, checking if the listening or client sockets need to be closed",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; before calling sys_exit",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "_exit",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", [sock]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "je",
      "highlight": "keyword"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ".client_check",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [sock]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "_close_sock",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    .client_check:",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", [client]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "cmp",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "0",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "je",
      "highlight": "keyword"
    },
    {
      "text": "         ",
      "highlight": null
    },
    {
      "text": ".perform_exit",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", [client]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "call",
      "highlight": "keyword"
    },
    {
      "text": "       ",
      "highlight": null
    },
    {
      "text": "_close_sock",
      "highlight": "property"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": "    .perform_exit:",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "60",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Utility/QoL code",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Writes a newline to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; Uses: rax, rdi, rsi, rdx",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "write_newline",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; file descriptor for STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "lea",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rsi",
      "highlight": "property"
    },
    {
      "text": ", [newline]",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdx",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "",
      "highlight": null
    }
  ],
  [
    {
      "text": ";; Writes a string to STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; Uses: rax, rdi, rsi, rdx",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": ";; Usage: rsi = pointer to string, rdx = length of string",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "write_string",
      "highlight": "function"
    },
    {
      "text": ":",
      "highlight": null
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rax",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; syscall number for SYS_WRITE",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "mov",
      "highlight": "keyword"
    },
    {
      "text": "     ",
      "highlight": null
    },
    {
      "text": "rdi",
      "highlight": "property"
    },
    {
      "text": ", ",
      "highlight": null
    },
    {
      "text": "1",
      "highlight": "number"
    },
    {
      "text": "        ",
      "highlight": null
    },
    {
      "text": "; file descriptor for STDOUT",
      "highlight": "comment"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "syscall",
      "highlight": "keyword"
    }
  ],
  [
    {
      "text": "    ",
      "highlight": null
    },
    {
      "text": "ret",
      "highlight": "keyword"
    }
  ]
]
